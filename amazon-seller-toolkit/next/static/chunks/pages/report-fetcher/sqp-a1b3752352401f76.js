!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},a=(new e.Error).stack;a&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[a]="81d2dae8-f76e-472f-ab87-df1f16cd55b6",e._sentryDebugIdIdentifier="sentry-dbid-81d2dae8-f76e-472f-ab87-df1f16cd55b6")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[138],{423:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/report-fetcher/sqp",function(){return t(55152)}])},66158:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});var n=t(17613),r=t.n(n);class s{}s.transformWeeklyDateString=e=>{let a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t=e.split(" | "),n=t[0],r=t[1].split(", "),s=r[0].split(" - "),i=r[1],l=n.replace(/Week\s/,""),[o,d]=s,p=new Date(o),c=new Date(d),u=a[p.getMonth()],g=p.getDate(),m=a[c.getMonth()],h=c.getDate();return"W".concat(l," | ").concat(u," ").concat(g,", ").concat(i," - ").concat(m," ").concat(h,", ").concat(i)},s.transformMonthlyDateString=(e,a)=>{let t=e.split("-")[0];return"".concat(a," ").concat(t)},s.transformQuarterlyDateString=(e,a)=>{let t=e.split("-")[0];return"Q".concat(a," ").concat(t)},s.mapWeeklyPeriods=e=>{var a,t,n,i;return null!==(i=null==e?void 0:null===(n=e.find(e=>"weekly"===e.value))||void 0===n?void 0:null===(t=n.child)||void 0===t?void 0:null===(a=t.values)||void 0===a?void 0:a.map(e=>{let{value:a,localizedDisplayValue:t}=e;return{date:r().utc(a),title:s.transformWeeklyDateString(t)}}))&&void 0!==i?i:[]},s.mapMonthlyPeriods=e=>{var a,t,n,i;return null!==(i=null==e?void 0:null===(n=e.find(e=>"monthly"===e.value))||void 0===n?void 0:null===(t=n.child)||void 0===t?void 0:null===(a=t.values)||void 0===a?void 0:a.reduce((e,a)=>{var t,n;let i=null!==(n=null==a?void 0:null===(t=a.child)||void 0===t?void 0:t.values.map(e=>{let{value:a,localizedDisplayValue:t}=e;return{date:r().utc(a),title:s.transformMonthlyDateString(a,t)}}))&&void 0!==n?n:[];return e.concat(i)},[]))&&void 0!==i?i:[]},s.mapQuarterlyPeriods=e=>{var a,t,n,i;return null!==(i=null==e?void 0:null===(n=e.find(e=>"quarterly"===e.value))||void 0===n?void 0:null===(t=n.child)||void 0===t?void 0:null===(a=t.values)||void 0===a?void 0:a.reduce((e,a)=>{var t,n;let i=null!==(n=null==a?void 0:null===(t=a.child)||void 0===t?void 0:t.values.map(e=>{let{value:a,localizedDisplayValue:t}=e;return{date:r().utc(a),title:s.transformQuarterlyDateString(a,t)}}))&&void 0!==n?n:[];return e.concat(i)},[]))&&void 0!==i?i:[]}},24872:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});var n=t(92027);class r{}r.sum=e=>e.reduce((e,a)=>e+a,0),r.average=(e,a)=>{if(!e.length)return"";let t=r.sum(e)/e.length;return n.Rx.roundToDecimalPoints(t,a)},r.calculatePercentage=(e,a)=>n.Rx.formatPercentage(e/(a||1))},97079:function(e,a,t){"use strict";var n=t(31549),r=t(53240),s=t(1311),i=t(1248);a.Z=e=>{let{disabled:a,value:t,onChange:l,groupingLabel:o}=e;return(0,n.jsx)(r.Z,{disabled:a,fullWidth:!0,label:"CSV grouping",name:"reportFileGroupingType",onChange:l,select:!0,value:t,"data-sentry-element":"TextField","data-sentry-component":"CSVGroupingPicker","data-sentry-source-file":"CSVGroupingPicker.tsx",children:["Single","Multiple","Aggregated"].map(e=>(0,n.jsx)(s.Z,{value:e,children:(0,i.Z)(o,e)},e))})}},91585:function(e,a,t){"use strict";var n=t(31549),r=t(44194),s=t(73207),i=t(53240),l=t(1311),o=t(60889),d=t(25882),p=t(1248);a.Z=e=>{let{disabled:a,formik:t,reportingRanges:c}=e,{label:u,options:g}=(0,r.useMemo)(()=>{switch(t.values.reportingRange){case"Weekly":return{label:"Weeks",options:null==c?void 0:c.weekly};case"Monthly":return{label:"Months",options:null==c?void 0:c.monthly};case"Quarterly":return{label:"Quarters",options:null==c?void 0:c.quarterly};default:throw Error("Unknown reporting range type")}},[t.values.reportingRange,c]);return(0,n.jsxs)(s.Z,{spacing:2,"data-sentry-element":"Stack","data-sentry-component":"ReportDateRangePicker","data-sentry-source-file":"ReportDateRangePicker.tsx",children:[(0,n.jsx)(i.Z,{disabled:a,fullWidth:!0,label:"Reporting range",name:"rangeType",onChange:e=>{t.setValues({...t.values,periods:[],reportingRange:e.target.value})},select:!0,value:t.values.reportingRange,"data-sentry-element":"TextField","data-sentry-source-file":"ReportDateRangePicker.tsx",children:p.T.map(e=>(0,n.jsx)(l.Z,{value:e,children:e},e))}),(0,n.jsx)(o.Z,{disableCloseOnSelect:!0,disabled:a,fullWidth:!0,getOptionLabel:e=>e.title,multiple:!0,onChange:(e,a)=>t.setFieldValue("periods",a),options:g,renderInput:e=>(0,n.jsx)(i.Z,{...e,label:u,placeholder:"Search and select ".concat(u.toLowerCase())}),renderOption:(e,a,t)=>{let{selected:s}=t;return(0,r.createElement)("li",{...e,key:a.title,children:[(0,n.jsx)(d.Z,{checked:s,style:{marginRight:8}}),a.title]})},value:t.values.periods,"data-sentry-element":"Autocomplete","data-sentry-source-file":"ReportDateRangePicker.tsx"})]})}},10604:function(e,a,t){"use strict";var n=t(31549),r=t(53240),s=t(1311),i=t(73207),l=t(78207),o=t(45576),d=t(49482),p=t(80230);a.Z=e=>{let{disabled:a,onChange:t}=e;return(0,n.jsx)(r.Z,{disabled:a,fullWidth:!0,label:"Marketplace",onChange:t,placeholder:"Search and select marketplaces",select:!0,"data-sentry-element":"TextField","data-sentry-component":"ReportMarketplaceSelect","data-sentry-source-file":"ReportMarketplaceSelect.tsx",children:Object.entries(p.aT).map(e=>{let[a,{name:t}]=e;return(0,n.jsx)(s.Z,{value:a,children:(0,n.jsxs)(i.Z,{alignItems:"center",direction:"row",spacing:1,children:[(0,n.jsx)(l.Z,{sx:{height:24,width:24},children:(0,n.jsx)(d.I,{icon:"circle-flags:".concat(a),sx:{height:"100%",width:"100%"}})}),(0,n.jsx)(o.Z,{variant:"body2",children:t})]})},t)})})}},55152:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return z}});var n=t(31549),r=t(29859),s=t(99876),i=t.n(s),l=t(92103),o=t(52519),d=t(44541),p=t(73207),c=t(13175),u=t(23795),g=t(44194),m=t(45304),h=t(18648),y=t(24643),q=t(83720),v=t(92027),Z=t(80230),f=t(39378),b=t.n(f),k=t(17613),S=t.n(k),w=t(31925),x=t(55696),P=t(24872);class D{}D.ASIN_AGGREGATORS={asin:e=>e.asin[0],"qp-asin-query":e=>e["qp-asin-query"][0],"qp-asin-query-rank":e=>P.Z.average(e["qp-asin-query-rank"],0),"qp-asin-query-volume":e=>P.Z.sum(e["qp-asin-query-volume"]),"qp-asin-impressions":e=>P.Z.sum(e["qp-asin-impressions"]),"qp-asin-count-impressions":e=>P.Z.sum(e["qp-asin-count-impressions"]),"qp-asin-share-impressions":e=>P.Z.calculatePercentage(P.Z.sum(e["qp-asin-count-impressions"]),P.Z.sum(e["qp-asin-impressions"])),"qp-asin-clicks":e=>P.Z.sum(e["qp-asin-clicks"]),"qp-click-rate":e=>P.Z.calculatePercentage(P.Z.sum(e["qp-asin-clicks"]),P.Z.sum(e["qp-asin-query-volume"])),"qp-asin-count-clicks":e=>P.Z.sum(e["qp-asin-count-clicks"]),"qp-asin-share-clicks":e=>P.Z.calculatePercentage(P.Z.sum(e["qp-asin-count-clicks"]),P.Z.sum(e["qp-asin-clicks"])),"qp-asin-median-query-price-clicks":e=>P.Z.average(e["qp-asin-median-query-price-clicks"],2),"qp-asin-median-price-clicks":e=>P.Z.average(e["qp-asin-median-price-clicks"],2),"qp-asin-same-day-shipping-clicks":e=>P.Z.sum(e["qp-asin-same-day-shipping-clicks"]),"qp-asin-one-day-shipping-clicks":e=>P.Z.sum(e["qp-asin-one-day-shipping-clicks"]),"qp-asin-two-day-shipping-clicks":e=>P.Z.sum(e["qp-asin-two-day-shipping-clicks"]),"qp-asin-cart-adds":e=>P.Z.sum(e["qp-asin-cart-adds"]),"qp-asin-cart-add-rate":e=>P.Z.calculatePercentage(P.Z.sum(e["qp-asin-cart-adds"]),P.Z.sum(e["qp-asin-query-volume"])),"qp-asin-count-cart-adds":e=>P.Z.sum(e["qp-asin-count-cart-adds"]),"qp-asin-share-cart-adds":e=>P.Z.calculatePercentage(P.Z.sum(e["qp-asin-count-cart-adds"]),P.Z.sum(e["qp-asin-cart-adds"])),"qp-asin-median-query-price-cart-adds":e=>P.Z.average(e["qp-asin-median-query-price-cart-adds"],2),"qp-asin-median-price-cart-adds":e=>P.Z.average(e["qp-asin-median-price-cart-adds"],2),"qp-asin-same-day-shipping-cart-adds":e=>P.Z.sum(e["qp-asin-same-day-shipping-cart-adds"]),"qp-asin-one-day-shipping-cart-adds":e=>P.Z.sum(e["qp-asin-one-day-shipping-cart-adds"]),"qp-asin-two-day-shipping-cart-adds":e=>P.Z.sum(e["qp-asin-two-day-shipping-cart-adds"]),"qp-asin-purchases":e=>P.Z.sum(e["qp-asin-purchases"]),"qp-asin-purchase-rate":e=>P.Z.calculatePercentage(P.Z.sum(e["qp-asin-purchases"]),P.Z.sum(e["qp-asin-query-volume"])),"qp-asin-count-purchases":e=>P.Z.sum(e["qp-asin-count-purchases"]),"qp-asin-share-purchases":e=>P.Z.calculatePercentage(P.Z.sum(e["qp-asin-count-purchases"]),P.Z.sum(e["qp-asin-purchases"])),"qp-asin-median-query-price-purchases":e=>P.Z.average(e["qp-asin-median-query-price-purchases"],2),"qp-asin-median-price-purchases":e=>P.Z.average(e["qp-asin-median-price-purchases"],2),"qp-asin-same-day-shipping-purchases":e=>P.Z.average(e["qp-asin-same-day-shipping-purchases"],2),"qp-asin-one-day-shipping-purchases":e=>P.Z.average(e["qp-asin-one-day-shipping-purchases"],2),"qp-asin-two-day-shipping-purchases":e=>P.Z.average(e["qp-asin-two-day-shipping-purchases"],2),marketplace:e=>e.marketplace[0],period:e=>e.period.join(";")},D.BRAND_AGGREGATORS={brand:e=>e.brand[0],"qp-brand-query":e=>e["qp-brand-query"][0],"qp-query-rank":e=>P.Z.average(e["qp-query-rank"],0),"qp-query-volume":e=>P.Z.sum(e["qp-query-volume"]),"qp-impressions":e=>P.Z.sum(e["qp-impressions"]),"qp-brand-count-impressions":e=>P.Z.sum(e["qp-brand-count-impressions"]),"qp-brand-share-impressions":e=>P.Z.calculatePercentage(P.Z.sum(e["qp-brand-count-impressions"]),P.Z.sum(e["qp-impressions"])),"qp-clicks":e=>P.Z.sum(e["qp-clicks"]),"qp-click-rate":e=>P.Z.calculatePercentage(P.Z.sum(e["qp-clicks"]),P.Z.sum(e["qp-query-volume"])),"qp-brand-count-clicks":e=>P.Z.sum(e["qp-brand-count-clicks"]),"qp-brand-share-clicks":e=>P.Z.calculatePercentage(P.Z.sum(e["qp-brand-count-clicks"]),P.Z.sum(e["qp-clicks"])),"qp-clicks-price":e=>P.Z.average(e["qp-clicks-price"],2),"qp-clicks-brand-price":e=>P.Z.average(e["qp-clicks-brand-price"],2),"qp-same-day-shipping-clicks":e=>P.Z.sum(e["qp-same-day-shipping-clicks"]),"qp-one-day-shipping-clicks":e=>P.Z.sum(e["qp-one-day-shipping-clicks"]),"qp-two-day-shipping-clicks":e=>P.Z.sum(e["qp-two-day-shipping-clicks"]),"qp-cart-adds":e=>P.Z.sum(e["qp-cart-adds"]),"qp-cart-add-rate":e=>P.Z.calculatePercentage(P.Z.sum(e["qp-cart-adds"]),P.Z.sum(e["qp-query-volume"])),"qp-cart-adds-brand-count":e=>P.Z.sum(e["qp-cart-adds-brand-count"]),"qp-cart-adds-brand-share":e=>P.Z.calculatePercentage(P.Z.sum(e["qp-cart-adds-brand-count"]),P.Z.sum(e["qp-cart-adds"])),"qp-cart-adds-price":e=>P.Z.average(e["qp-cart-adds-price"],2),"qp-same-day-shipping-cart-adds":e=>P.Z.sum(e["qp-same-day-shipping-cart-adds"]),"qp-one-day-shipping-cart-adds":e=>P.Z.sum(e["qp-one-day-shipping-cart-adds"]),"qp-two-day-shipping-cart-adds":e=>P.Z.sum(e["qp-two-day-shipping-cart-adds"]),"qp-purchases":e=>P.Z.sum(e["qp-purchases"]),"qp-purchase-rate":e=>P.Z.calculatePercentage(P.Z.sum(e["qp-purchases"]),P.Z.sum(e["qp-query-volume"])),"qp-purchases-brand-count":e=>P.Z.sum(e["qp-purchases-brand-count"]),"qp-purchases-brand-share":e=>P.Z.calculatePercentage(P.Z.sum(e["qp-purchases-brand-count"]),P.Z.sum(e["qp-purchases"])),"qp-purchase-price":e=>P.Z.average(e["qp-purchase-price"],2),"qp-purchases-brand-price":e=>P.Z.average(e["qp-purchases-brand-price"],2),"qp-same-day-shipping-purchases":e=>P.Z.average(e["qp-same-day-shipping-purchases"],2),"qp-one-day-shipping-purchases":e=>P.Z.average(e["qp-one-day-shipping-purchases"],2),"qp-two-day-shipping-purchases":e=>P.Z.average(e["qp-two-day-shipping-purchases"],2),marketplace:e=>e.marketplace[0],period:e=>e.period.join(";")},D.aggregateData=(e,a)=>{let t=new Map;e.forEach(e=>{let{[a]:n,["qp-".concat(a,"-query")]:r,marketplace:s,period:i,...l}=e,o="".concat(n," ").concat(r);t.has(o)||t.set(o,{marketplace:[s],period:[],["qp-".concat(a,"-query")]:[r],[a]:[n]});let d=t.get(o);d.period.push(i),Object.entries(l).forEach(e=>{let[a,t]=e;a in d&&"-"!==t||(d[a]=[]),"-"!==t&&d[a].push(+t)})});let n="asin"===a?D.ASIN_AGGREGATORS:D.BRAND_AGGREGATORS;return Array.from(t.values()).map(e=>{let a={};return Object.keys(n).forEach(t=>{a[t]=String(n[t](e))}),a})};class R{}R.generateSingleFetchInput=(e,a,t,n,r)=>{let s=q.Z.getRangeFiltersByReportingRange(a,r),i="ASIN"===n;return{payload:{filterSelections:[{id:i?"asin":"brand",value:t,valueType:i?"ASIN":null},{id:"reporting-range",value:a.toLowerCase(),valueType:null},...s],reportId:i?"query-performance-asin-report-table":"query-performance-brand-report-table",reportOperations:[{ascending:!0,pageNumber:1,pageSize:100,reportId:i?"query-performance-asin-report-table":"query-performance-brand-report-table",reportType:"TABLE",sortByColumnId:i?"qp-asin-query-rank":"qp-query-rank"}],selectedCountries:[e],viewId:i?"query-performance-asin-view":"query-performance-brands-view"},periodEndDate:r.toISOString()}},R.generateAPIInputs=(e,a,t,n,r)=>{let s={};return r.forEach(r=>{s[r]=a.map(a=>R.generateSingleFetchInput(e,t,r,n,S().tz(a,v.SL)))}),s},R.downloadAllData=async(e,a,t,n,r,s)=>{var i,l,o,d;let p="Brand"===a,{marketplaceCode:c,reportingRange:u,reportFileGroupingType:g,downloadDestinationType:m}=s,h=[],y=[],f=R.generateAPIInputs(c,s.periods.map(e=>{let{date:a}=e;return a.utc().toISOString()}),u,a,q.Z.convertMultilineTextToArray("Brand"===a?s.brands:s.asins)),k=p?x.Z.SQP_BRAND_DATA_COLUMNS:x.Z.SQP_ASIN_DATA_COLUMNS,P=p?10:1,A=Object.entries(f),I=A.length*((null===(l=A[0])||void 0===l?void 0:null===(i=l[1])||void 0===i?void 0:i.length)||0)*P;for(let[a,[i,l]]of A.entries()){let f=[],x=!1;for(let[n,{payload:s,periodEndDate:g}]of l.entries()){let m=b().range(P).map(e=>b().cloneDeep({...s,reportOperations:s.reportOperations.map(a=>({...a,pageNumber:e+1}))})),y=[];for(let[s,f]of m.entries())try{let{rows:a}=await w.Z.fetchSQPAPIData(e,f,p);a.forEach(e=>{if(p){var a,t;e.brand=null!==(t=null===(a=r.find(e=>e.value===i))||void 0===a?void 0:a.localizedDisplayValue)&&void 0!==t?t:i}else e.asin=i;e.marketplace=Z.aT[c].name,e.period=q.Z.getFormattedPeriod(u,g);let n=p?"qp-brand-query":"qp-asin-query";q.Z.sanitizeValuesWithComma([n],e)}),y.push(...a)}catch(e){q.Z.handleNetworkError(e),x=!0,p?h.push(null!==(d=null===(o=r.find(e=>e.value===i))||void 0===o?void 0:o.localizedDisplayValue)&&void 0!==d?d:i):h.push(i);break}finally{t((P*(a*l.length+n)+(s+1))/I*100);let e=a!==A.length-1||n!==l.length-1||s!==m.length-1?q.Z.getSellerCentralSleepTime():0;await v.ZP.sleep(e)}if(x)break;{let e=p?"qp-query-rank":"qp-asin-query-rank";f.push(...y.sort((a,t)=>parseInt(a[e],10)-parseInt(t[e],10)))}}x||("Multiple"===g?n({..."Local"!==m?{..."Google Sheet"===m?{csvData:f}:{sheetDataToWriteToDrive:q.Z.generateSheetData(f,k)}}:{csvText:q.Z.generateCSVText(f,k)},fileName:"".concat(i,"-sqp-data-").concat(S()().toISOString().split(".")[0]),destination:m,reportFormData:s}):y.push(...f))}if("Multiple"!==g&&h.length!==A.length){let e="Aggregated"===g,a=e?D.aggregateData(y,p?"brand":"asin"):y;n({..."Local"!==m?{..."Google Sheet"===m?{csvData:a}:{sheetDataToWriteToDrive:q.Z.generateSheetData(e?D.aggregateData(y,p?"brand":"asin"):y,k)}}:{csvText:q.Z.generateCSVText(e?D.aggregateData(y,p?"brand":"asin"):y,k)},fileName:"multi-".concat(p?"brand":"asin").concat(e?"-agg":"","-sqp-data-").concat(S()().toISOString().split(".")[0]),destination:m,reportFormData:s})}return h};var A=t(66158);class I{}I.getMetadata=async e=>{var a,t,n,r,s,i,l,o,d,p,c;let u=await w.Z.fetchSQPMetadata(e),g=null==u?void 0:null===(t=u.metadata)||void 0===t?void 0:null===(a=t.viewsRoot)||void 0===a?void 0:a.views.find(e=>"query-performance-brands-view"===e.id),m=null==u?void 0:null===(o=u.metadata)||void 0===o?void 0:null===(l=o.viewsRoot)||void 0===l?void 0:null===(i=l.views)||void 0===i?void 0:null===(s=i.find(e=>"query-performance-asin-view"===e.id))||void 0===s?void 0:null===(r=s.filters)||void 0===r?void 0:null===(n=r.find(e=>"reporting-range"===e.id))||void 0===n?void 0:n.values,h=null!==(c=null==g?void 0:null===(d=g.filters.find(e=>"brand"===e.id))||void 0===d?void 0:d.values)&&void 0!==c?c:[],y=null==g?void 0:null===(p=g.filters.find(e=>"reporting-range"===e.id))||void 0===p?void 0:p.values;return{asins:{reportingRanges:{monthly:A.Z.mapMonthlyPeriods(m),quarterly:A.Z.mapQuarterlyPeriods(m),weekly:A.Z.mapWeeklyPeriods(m)}},brands:{options:h,reportingRanges:{monthly:A.Z.mapMonthlyPeriods(y),quarterly:A.Z.mapQuarterlyPeriods(y),weekly:A.Z.mapWeeklyPeriods(y)}}}};var T=t(11330),j=t(78839),C=t(19034),N=t(7597),M=t(58362),Q=t(53240),_=t(60889),O=t(25882),F=t(46377),B=t(61600),E=t(97079),G=t(91585),W=t(10604),V=e=>{var a,t;let{isLoading:r,tabValue:s,formik:i,disabled:l,metadata:o}=e,d="ASIN"===s?null==o?void 0:null===(a=o.asins)||void 0===a?void 0:a.reportingRanges:null==o?void 0:null===(t=o.brands)||void 0===t?void 0:t.reportingRanges,p=(0,g.useMemo)(()=>{var e;return"ASIN"===s?(0,n.jsx)(Q.Z,{disabled:l,error:!!(i.errors.asins&&i.touched.asins),fullWidth:!0,helperText:i.touched.asins?i.errors.asins:null,id:"asins",label:"Enter ASINs separated by new lines",multiline:!0,name:"asins",onBlur:i.handleBlur,onChange:i.handleChange,rows:8,value:i.values.asins,variant:"outlined"}):(0,n.jsx)(_.Z,{disableCloseOnSelect:!0,disabled:l,fullWidth:!0,getOptionLabel:e=>null==e?void 0:e.localizedDisplayValue,multiple:!0,onChange:(e,a)=>{let t=a.map(e=>e.value).join("\n");i.setFieldValue("brands",t)},options:(null==o?void 0:null===(e=o.brands)||void 0===e?void 0:e.options)||[],renderInput:e=>(0,n.jsx)(Q.Z,{...e,label:"Brands",placeholder:"Search and select brands"}),renderOption:(e,a,t)=>{let{selected:r}=t;return(0,g.createElement)("li",{...e,key:a.localizedDisplayValue,children:[(0,n.jsx)(O.Z,{checked:r,style:{marginRight:8}}),a.localizedDisplayValue]})}})},[l,i,o,s]),c=F.Z.isInvalidDestination(i.values);return(0,n.jsxs)(n.Fragment,{children:[p,(0,n.jsx)(W.Z,{disabled:l,onChange:e=>i.setFieldValue("marketplaceCode",e.target.value),"data-sentry-element":"ReportMarketplaceSelect","data-sentry-source-file":"SQPForm.tsx"}),(0,n.jsx)(E.Z,{disabled:l,groupingLabel:"ASIN"===s?"ASIN":"Brand",onChange:i.handleChange,value:i.values.reportFileGroupingType,"data-sentry-element":"CSVGroupingPicker","data-sentry-source-file":"SQPForm.tsx"}),(0,n.jsx)(G.Z,{disabled:l,formik:i,reportingRanges:d,"data-sentry-element":"ReportDateRangePicker","data-sentry-source-file":"SQPForm.tsx"}),(0,n.jsx)(B.Z,{disabled:l,formik:i,reportType:"ASIN"===s?"SQPASINs":"SQPBrands","data-sentry-element":"DataDestinationPicker","data-sentry-source-file":"SQPForm.tsx"}),(0,n.jsx)(M.Z,{disabled:!i.isValid||c||l,loading:r,onClick:i.submitForm,variant:"contained","data-sentry-element":"LoadingButton","data-sentry-source-file":"SQPForm.tsx",children:"Submit"})]})},L=()=>{let e=(0,m.v9)(y.Z.activeMarketplaceSelector),[a,t]=(0,g.useState)("ASIN"),{loadingDetails:r,downloadReport:s,fetchMetadata:i,metadata:v,metadataStatus:Z,setUploadProgress:f,setDownloadProgress:b}=(0,N.Z)(I.getMetadata,{asins:{reportingRanges:{monthly:[],quarterly:[],weekly:[]}},brands:{options:[],reportingRanges:{monthly:[],quarterly:[],weekly:[]}}}),k=async t=>{try{let n=await R.downloadAllData(e,a,b,s,v.brands.options,t);n.length&&(0,c.yv)("The following ".concat("Brand"===a?"Brands":"ASINs"," failed to download data: ").concat(n.join(", ")),{persist:!0,preventDuplicate:!1,variant:"error"})}catch(e){(0,c.yv)((null==e?void 0:e.message)||"Something went wrong",{variant:"error"})}finally{f(0),b(null)}},S=(0,u.TA)({initialValues:{asins:"",brands:"",reportFileGroupingType:"Single",downloadDestinationType:"Local",menuItemDestination:"Local",dataConfigurationId:"",marketplaceCode:"",isSavingToPreviousDestination:!1,periods:[],reportingRange:"Weekly",reportType:"SQPBrands"},onSubmit:async(e,a)=>{b(0),await k(e),a.setSubmitting(!1)},validationSchema:h.Ry().shape({brands:h.Z_().required("You must enter at least one brand"),marketplaceCode:h.Z_().required("You must select a marketplace"),periods:h.IX().required().test("periods","You must select at least one period",e=>!!e.length)})}),w=(0,u.TA)({initialValues:{asins:"",brands:"",reportFileGroupingType:"Single",downloadDestinationType:"Local",menuItemDestination:"Local",dataConfigurationId:"",marketplaceCode:"",isSavingToPreviousDestination:!1,periods:[],reportingRange:"Weekly",reportType:"SQPBrands"},onSubmit:async(e,a)=>{b(0),await k(e),a.setSubmitting(!1)},validationSchema:h.Ry().shape({asins:h.Z_().required("You must enter at least one ASIN").test("asins","One of your ASINs contains invalid characters",e=>q.Z.convertMultilineTextToArray(e).every(e=>!/[^A-Z0-9]/.test(e))),marketplaceCode:h.Z_().required("You must select a marketplace"),periods:h.IX().required().test("periods","You must select at least one period",e=>!!e.length)})});return(0,n.jsxs)(j.Z,{title:"Search Query Performance",tutorialUrl:"https://www.youtube.com/watch?v=Gt9ABKv_qnc","data-sentry-element":"ReportFormContainer","data-sentry-component":"ReportFetcher","data-sentry-source-file":"SQPReport.tsx",children:[(0,n.jsx)(T.Z,{fetchMetadata:i,metadataStatus:Z,"data-sentry-element":"NoActiveSessionAlert","data-sentry-source-file":"SQPReport.tsx"}),(0,n.jsx)(l.Z,{sx:{paddingBottom:2},"data-sentry-element":"Box","data-sentry-source-file":"SQPReport.tsx",children:(0,n.jsx)(o.Z,{onChange:(e,a)=>{t(a)},value:a,variant:"fullWidth","data-sentry-element":"Tabs","data-sentry-source-file":"SQPReport.tsx",children:["ASIN","Brand"].map(e=>(0,n.jsx)(d.Z,{label:e,value:e},e))})}),(0,n.jsxs)(p.Z,{spacing:2,"data-sentry-element":"Stack","data-sentry-source-file":"SQPReport.tsx",children:[(0,n.jsx)(V,{disabled:!!r||"success"!==Z,formik:"ASIN"===a?w:S,isLoading:!!r,metadata:v,tabValue:a,"data-sentry-element":"SQPForm","data-sentry-source-file":"SQPReport.tsx"},a),r?(0,n.jsx)(C.Z,{label:r.label,progress:r.progress}):null]})]})},z=()=>{let{appName:e}=(0,r.b)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i(),{"data-sentry-element":"Head","data-sentry-source-file":"sqp.tsx",children:(0,n.jsx)("title",{children:"SQP Report | ".concat(e)})}),(0,n.jsx)(L,{"data-sentry-element":"SQPReport","data-sentry-source-file":"sqp.tsx"})]})}},1248:function(e,a,t){"use strict";t.d(a,{T:function(){return n},Z:function(){return r}});let n=["Weekly","Monthly","Quarterly"],r=(e,a)=>({Aggregated:"One file for all ".concat(e,"s - Aggregated"),Multiple:"One file per-".concat(e),Single:"One file for all ".concat(e,"s")})[a]}},function(e){e.O(0,[718,509,40,724,987,888,774,179],function(){return e(e.s=423)}),_N_E=e.O()}]);